import tensorflow as tf
from .images import resize, random_crop


@tf.function()
def random_jitter(input_image, real_image, IMG_HEIGHT, IMG_WIDTH):
  # resizing to 286 x 286 x 3
  input_image, real_image = resize(input_image, real_image, 286, 286)

  # randomly cropping to 256 x 256 x 3
  input_image, real_image = random_crop(input_image, real_image, IMG_HEIGHT, IMG_WIDTH)

  if tf.random.uniform(()) > 0.5:
    # random mirroring
    input_image = tf.image.flip_left_right(input_image)
    real_image = tf.image.flip_left_right(real_image)

  return input_image, real_image
